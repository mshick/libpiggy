{"version":3,"sources":["../src/create-watched-table.js"],"names":["createWatchedTable","client","table","columns","key","then","query","results"],"mappings":";;;;;;AAAA;;;;;;AAEA,MAAMA,qBAAqB,UAAU,EAACC,MAAD,EAASC,KAAT,EAAgBC,OAAhB,EAAyBC,GAAzB,EAAV,EAAyC;AAClE,SAAO,mCAAoB,EAACH,MAAD,EAASG,GAAT,EAApB,EACJC,IADI,CACC,MAAM;AACV,WAAOJ,OAAOK,KAAP,CAAc;qCACUJ,KAAM,KAAIC,OAAQ;gDACPD,KAAM;oCAClBA,KAAM;;OAH7B,CAAP;AAMD,GARI,EASJG,IATI,CASCE,WAAW;AACf,WAAO;AACLN,YADK;AAELM;AAFK,KAAP;AAID,GAdI,CAAP;AAeD,CAhBD;;kBAkBeP,kB","file":"create-watched-table.js","sourcesContent":["import createNotifyTrigger from './create-notify-trigger';\n\nconst createWatchedTable = function ({client, table, columns, key}) {\n  return createNotifyTrigger({client, key})\n    .then(() => {\n      return client.query(`\n        CREATE TABLE IF NOT EXISTS ${table} (${columns});\n        CREATE TRIGGER watched_table_trigger__${table}\n        AFTER INSERT OR UPDATE ON ${table}\n        FOR EACH ROW EXECUTE PROCEDURE notify_trigger();\n      `);\n    })\n    .then(results => {\n      return {\n        client,\n        results\n      };\n    });\n};\n\nexport default createWatchedTable;\n"]}